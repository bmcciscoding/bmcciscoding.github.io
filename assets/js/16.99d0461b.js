(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{480:function(e,t,a){"use strict";a.r(t);var n=a(10),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"多线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多线程"}},[e._v("#")]),e._v(" 多线程")]),e._v(" "),a("p",[e._v("多线程操作很复杂：死锁，数据竞争。在 iOS 中，多线程操作主要有 NSThread，NSOperation，GCD。")]),e._v(" "),a("p",[a("strong",[e._v("死锁")])]),e._v(" "),a("div",{staticClass:"language-Objective-C extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('NSLog(@"1");\n// 1 dispatch_queue_t queue = dispatch_get_main_queue();\n// 2 dispatch_queue_t queue = dispatch_queue_create("serial", DISPATCH_QUEUE_SERIAL); \ndispatch_sync(queue, ^{\n    NSLog(@"%@ 2", NSThread.currentThread);\n});\nNSLog(@"3");\n')])])]),a("p",[e._v("打开注释1会输出什么？打开注释2会输出什么？NSThread.currentThread 会输出什么？\n答案是 1 会死锁，2 不会。current thread 会输出 main thread。")]),e._v(" "),a("p",[a("strong",[e._v("竞争")])]),e._v(" "),a("div",{staticClass:"language-Objective-C extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('__block int a = 0;\ndispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);\nfor (int i=0; i<10; i++) {\n    dispatch_async(queue, ^{\n        int b = a;\n        [NSThread sleepForTimeInterval:0.01];\n        a = b + 1;\n    });\n}\nsleep(1);\nNSLog(@"%d", a);\n')])])])])}),[],!1,null,null,null);t.default=s.exports}}]);