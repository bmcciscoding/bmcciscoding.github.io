<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>shell 简单入门 | 寒冰阁序</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" type="image/png" href="./favicon.png">
    <meta name="description" content="现在我们项目的开发流程大概是这样的：

在自己的分支修改代码
pull develop 分支代码到最新
rebase develop 到自己到分支
如果有冲突，解决冲突
push 自己分支代码到云端
在lab上提 merget request: 选择分支、指定对方
然后在企业微信小窗私聊他

不管是 git 命令行，还是终端工具，还是很繁琐的。而且每次提交 ...">
    
    <link rel="preload" href="/assets/css/0.styles.8bbe3483.css" as="style"><link rel="preload" href="/assets/js/app.3b107010.js" as="script"><link rel="preload" href="/assets/js/6.1d190480.js" as="script"><link rel="preload" href="/assets/js/3.41d2f1e3.js" as="script"><link rel="preload" href="/assets/js/28.f3be2872.js" as="script"><link rel="prefetch" href="/assets/js/10.57570850.js"><link rel="prefetch" href="/assets/js/11.f4014f88.js"><link rel="prefetch" href="/assets/js/12.c14d23f8.js"><link rel="prefetch" href="/assets/js/13.76361d67.js"><link rel="prefetch" href="/assets/js/14.e24d5c17.js"><link rel="prefetch" href="/assets/js/15.667fd8d4.js"><link rel="prefetch" href="/assets/js/16.99d0461b.js"><link rel="prefetch" href="/assets/js/17.0085edab.js"><link rel="prefetch" href="/assets/js/18.59304cee.js"><link rel="prefetch" href="/assets/js/19.573e27f5.js"><link rel="prefetch" href="/assets/js/20.170379ce.js"><link rel="prefetch" href="/assets/js/21.114eeab8.js"><link rel="prefetch" href="/assets/js/22.0b4fda6d.js"><link rel="prefetch" href="/assets/js/23.508f029c.js"><link rel="prefetch" href="/assets/js/24.8df22d57.js"><link rel="prefetch" href="/assets/js/25.ed3f9c64.js"><link rel="prefetch" href="/assets/js/26.fdaad824.js"><link rel="prefetch" href="/assets/js/27.ae095ed2.js"><link rel="prefetch" href="/assets/js/29.0e288c4c.js"><link rel="prefetch" href="/assets/js/30.67bb441e.js"><link rel="prefetch" href="/assets/js/31.ecdd1fb4.js"><link rel="prefetch" href="/assets/js/32.387b5800.js"><link rel="prefetch" href="/assets/js/33.9ba17277.js"><link rel="prefetch" href="/assets/js/34.ba8223a2.js"><link rel="prefetch" href="/assets/js/4.6471d74d.js"><link rel="prefetch" href="/assets/js/5.ad6a474c.js"><link rel="prefetch" href="/assets/js/7.5f9bd84f.js"><link rel="prefetch" href="/assets/js/8.427074d3.js"><link rel="prefetch" href="/assets/js/9.77f58b60.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.a140baa0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8bbe3483.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">寒冰阁序 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">寒冰阁序 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        shell 简单入门
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-06-06T02:25:39.000Z">
      Sat Jun 06 2020
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/技术" data-v-42ccfcd5><span data-v-42ccfcd5>技术</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>现在我们项目的开发流程大概是这样的：</p> <ol><li>在自己的分支修改代码</li> <li>pull develop 分支代码到最新</li> <li>rebase develop 到自己到分支</li> <li>如果有冲突，解决冲突</li> <li>push 自己分支代码到云端</li> <li>在lab上提 merget request: 选择分支、指定对方</li> <li>然后在企业微信小窗私聊他</li></ol> <p>不管是 git 命令行，还是终端工具，还是很繁琐的。而且每次提交，都是重复都流程，是在难以忍受。
因此通过 shell 脚本，规整了流程，达到<strong>一行代码：sh flow.sh</strong>完成整个流程。</p> <p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfcu6qb9r7j30er0rx42x.jpg" alt=""></p> <h2 id="认识-shell-命令"><a href="#认识-shell-命令" class="header-anchor">#</a> 认识 shell 命令</h2> <p><code>echo hello world</code> <code>ls -r</code> <code>ls --reverse</code></p> <p>[command] [arg1] 是格式</p> <p><code>ls ; cat podfile</code>：执行 ls，不管成功还是失败，都会执行 cat
<code>ls &amp;&amp; cat podfile</code>： 执行 ls，如果成功，才会执行 cat
<code>ls || cat podfile</code>：执行 ls，如果失败了，才会执行 cat</p> <h2 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token number">10</span> <span class="token comment"># =左右两边不能有空格</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$var1</span>   <span class="token comment"># 使用变量一定要加$</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${var2}</span> <span class="token comment"># 也可以使用 ${} 的方式</span>
</code></pre></div><p>所有的变量都是字符串</p> <h3 id="运算"><a href="#运算" class="header-anchor">#</a> 运算</h3> <p><code>$((...))</code></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token variable">))</span></span> <span class="token comment"># 8</span>

<span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token number">7</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>var <span class="token operator">+</span> <span class="token number">3</span><span class="token variable">))</span></span> <span class="token comment"># 10</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>$var <span class="token operator">+</span> <span class="token number">3</span><span class="token variable">))</span></span> <span class="token comment"># 10，加上$是一样的，但是建议加上，能够高亮，方便阅读</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">5</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token variable">))</span></span>   <span class="token comment"># 2</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">5.0</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token variable">))</span></span> <span class="token comment"># 2.5</span>

<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token operator">++</span>i<span class="token variable">))</span></span> <span class="token comment"># 1</span>

<span class="token function">expr</span> <span class="token number">3</span> + <span class="token number">2</span> <span class="token comment"># 5，需要注意空格，并且只支持证书</span>
</code></pre></div><h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token string">&quot;my name is shell&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>var}</span>       <span class="token comment"># 获取长度 16</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${var<span class="token operator">:</span>3}</span>      <span class="token comment"># 截取字符串，从第3个字符开始  name is shell</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${var<span class="token operator">:</span>3<span class="token operator">:</span>4}</span>    <span class="token comment"># 截取字符串，从第3个字符开始，一直到之后的4个字符  name</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${var<span class="token operator">:</span> -5}</span>    <span class="token comment"># 截取字符串，从倒数5个开始</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${var<span class="token operator">:</span> -5<span class="token operator">:</span>2}</span>  <span class="token comment"># 截取字符串，从倒数5个开始，一直到之后的2个字符 sh </span>
</code></pre></div><h3 id="逻辑"><a href="#逻辑" class="header-anchor">#</a> 逻辑</h3> <p><strong>if</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">## 条件</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> 表达式 <span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token keyword">then</span>
  <span class="token comment"># do something </span>
<span class="token keyword">elif</span> 表达式<span class="token punctuation">;</span> 
<span class="token keyword">then</span>
  <span class="token comment"># do something</span>
<span class="token keyword">else</span>
  <span class="token comment"># do somethig</span>
<span class="token keyword">fi</span>
</code></pre></div><p>条件判断逻辑还是一样，但是写法需要注意</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 数字比较</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -eq <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># ==</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -nq <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># !=</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -le <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># &lt;=</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -lt <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># &lt;</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -ge <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># &gt;=</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -gt <span class="token number">5</span> <span class="token punctuation">]</span> <span class="token comment"># &gt;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token number">3</span> -eq <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token builtin class-name">echo</span> good<span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token builtin class-name">echo</span> bad<span class="token punctuation">;</span> <span class="token keyword">fi</span> 
</code></pre></div><p><strong>switch...case</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token string">'my name is shell'</span>
<span class="token keyword">case</span> <span class="token variable">$var</span> <span class="token keyword">in</span>
  <span class="token number">1</span> <span class="token punctuation">)</span>
    commands 
    <span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token comment"># break</span>
  <span class="token number">2</span> <span class="token punctuation">)</span>
    commands 
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  * <span class="token punctuation">)</span> <span class="token comment"># defautl</span>
    commands 
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre></div><p><strong>for</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">0</span> <span class="token comment"># 相当于 index</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">branch</span> <span class="token keyword">in</span> <span class="token variable">${list<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>  <span class="token comment"># @ 这个很精髓</span>
<span class="token keyword">do</span>
    <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$i<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $i % <span class="token number">2</span><span class="token variable">`</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span>
    <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[1;37m<span class="token variable">$i</span>: <span class="token variable">$branch</span> <span class="token entity" title="\033">\033</span>[0m&quot;</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$i</span>: <span class="token variable">$branch</span>&quot;</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre></div><p><strong>while</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -lt <span class="token variable">${<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">${ array<span class="token punctuation">[</span>$i<span class="token punctuation">]</span> }</span>
    <span class="token builtin class-name">let</span> i++
<span class="token keyword">done</span>
</code></pre></div><h2 id="输入与输出"><a href="#输入与输出" class="header-anchor">#</a> 输入与输出</h2> <p><strong>echo</strong>
echo 就是打印，</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">'hello shell'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'hello shell'</span> <span class="token operator">&gt;</span> info.txt  <span class="token comment"># 输出到文件</span>
</code></pre></div><p><strong>read</strong></p> <p><code>read var1</code> 即可接受输出变量，当然 read 也可以接受一些参数，
比如 <code>read -p &quot;type number&quot; var2</code>，会先展示文本，然后再接受输入</p> <h2 id="脚本"><a href="#脚本" class="header-anchor">#</a> 脚本</h2> <p>了解这些简单的概念，就已经可以写脚本了。相当于之前需要一行一行在命令行写下的命令，都可以全部写到一个脚本里，然后执行脚本来完成。对于一些重复，高频的工作，用脚本可以极大的提升效率，舒缓心情。</p> <h2 id="常用-shell-命令"><a href="#常用-shell-命令" class="header-anchor">#</a> 常用 shell 命令</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 分割字符串转数组</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">${string<span class="token operator">/</span><span class="token operator">/</span>$key<span class="token operator">:</span><span class="token operator">/</span>}</span><span class="token punctuation">)</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $string <span class="token operator">|</span> <span class="token function">tr</span> $key <span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span><span class="token variable">)</span></span><span class="token punctuation">)</span>

<span class="token comment"># echo 颜色</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[31m 红色字 <span class="token entity" title="\033">\033</span>[0m&quot;</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[41;37m 红底白字 <span class="token entity" title="\033">\033</span>[0m&quot;</span>
</code></pre></div></div> <footer><!----> <hr> <!----></footer></article> <!----></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3b107010.js" defer></script><script src="/assets/js/6.1d190480.js" defer></script><script src="/assets/js/3.41d2f1e3.js" defer></script><script src="/assets/js/28.f3be2872.js" defer></script>
  </body>
</html>
